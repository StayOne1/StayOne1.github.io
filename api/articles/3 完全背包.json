{"title":"3 完全背包","uid":"6caea40c9fab236139a1dd0f7cc85795","slug":"3 完全背包","date":"2025-03-04T16:00:00.000Z","updated":"2025-03-07T14:18:35.157Z","comments":true,"path":"api/articles/3 完全背包.json","keywords":null,"cover":null,"content":"<h2 id=\"题目描述\">题目描述</h2>\n<p>有 N 种物品和一个容量是 V 的背包，每种物品都有无限件可用。</p>\n<p>第 i 种物品的体积是 vi，价值是 wi 。</p>\n<p>求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。<br>\n输出最大价值。</p>\n<h5 id=\"输入样例\">输入样例</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">4 5</span><br><span class=\"line\">1 2</span><br><span class=\"line\">2 4</span><br><span class=\"line\">3 4</span><br><span class=\"line\">4 5</span><br></pre></td></tr></table></figure>\n<h5 id=\"输出样例\">输出样例</h5>\n<p>10</p>\n<h2 id=\"原题链接\">原题链接</h2>\n<ul>\n<li><a href=\"https://www.acwing.com/problem/content/description/3/\">AcWing</a></li>\n</ul>\n<hr>\n<h2 id=\"解题思路\">解题思路</h2>\n<p>考虑跟0-1背包一样的状态表示， 但要主要这里的物品可以无限去选， 因此在做状态转移时需要枚举物品的个数K</p>\n<h2 id=\"代码\">代码</h2>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e3</span> + <span class=\"number\">10</span> ;</span><br><span class=\"line\"><span class=\"type\">int</span> n , m ;</span><br><span class=\"line\"><span class=\"type\">int</span> w[N] , v[N] ;</span><br><span class=\"line\"><span class=\"type\">int</span> f[N][N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m ;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++) cin &gt;&gt; w[i] &gt;&gt; v[i] ;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = <span class=\"number\">1</span> ; j &lt;= m ; j++)&#123;</span><br><span class=\"line\">            f[i][j] = f[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"type\">int</span> k = <span class=\"number\">1</span> ; j &gt;= w[i] * k ;k++)&#123;</span><br><span class=\"line\">                f[i][j] = <span class=\"built_in\">max</span>(f[i][j] , f[i<span class=\"number\">-1</span>][j-w[i]*k] + v[i] * k);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; f[n][m];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n<p>复杂度较高，会超时</p>\n<h2 id=\"优化1\">优化1</h2>\n<p>展开枚举，观察状态转移计算</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">记w[i] = w ,v[i] = i</span><br><span class=\"line\"></span><br><span class=\"line\">f[i][j]   = max(f[i-1][j] , f[i-1][j-w]+v , f[i-1][j-2w]+2v , ...)</span><br><span class=\"line\"></span><br><span class=\"line\">f[i][j-w] = max(            f[i-1][j-w] , f[i-1][j-2w]+v , f[i-1][j-3w]+2v ,...)</span><br><span class=\"line\"></span><br><span class=\"line\">归纳发现, f[i][j] = max( f[i - 1][j], f[i][j - w] + v ) </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>因此，可以不用枚举，直接用 j-w 的状态计算</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e3</span> + <span class=\"number\">10</span> ;</span><br><span class=\"line\"><span class=\"type\">int</span> n , m ;</span><br><span class=\"line\"><span class=\"type\">int</span> w[N] , v[N] ;</span><br><span class=\"line\"><span class=\"type\">int</span> f[N][N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m ;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++) cin &gt;&gt; w[i] &gt;&gt; v[i] ;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = <span class=\"number\">0</span> ; j &lt;= m ; j++)&#123;</span><br><span class=\"line\">            f[i][j] = f[i<span class=\"number\">-1</span>][j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j &gt;= w[i]) f[i][j] = <span class=\"built_in\">max</span>(f[i][j] , f[i][j - w[i] ] + v[i] );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; f[n][m];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"优化2\">优化2</h2>\n<p>类比0-1背包，二维转一维</p>\n<p>与01背包不同，完全背包的状态依赖是正上方和同一行的左边</p>\n<p>因此我们考虑正向遍历，从左到右更新数组</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这样以来当我们计算到f[j]时，当前f[j]记录的是前一行的f[j]，f[j-w]是当前行的f[j]，</span><br><span class=\"line\">如此覆盖就是合法的了</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&lt;algorithm&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std ;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">int</span> N = <span class=\"number\">1e3</span> + <span class=\"number\">10</span> ;</span><br><span class=\"line\"><span class=\"type\">int</span> n , m ;</span><br><span class=\"line\"><span class=\"type\">int</span> w[N] , v[N] ;</span><br><span class=\"line\"><span class=\"type\">int</span> f[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m ;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++) cin &gt;&gt; w[i] &gt;&gt; v[i] ;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i = <span class=\"number\">1</span> ; i &lt;= n ; i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> j = w[i] ; j &lt;= m ; j++)&#123;</span><br><span class=\"line\">            f[j] = <span class=\"built_in\">max</span>(f[j] , f[j - w[i] ] + v[i] );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; f[m];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"相似题目\">相似题目</h2>\n<ul>\n<li><a href=\"\"> </a></li>\n<li><a href=\"\"> </a></li>\n</ul>\n","feature":true,"text":"题目描述 有 N 种物品和一个容量是 V 的背包，每种物品都有无限件可用。 第 i 种物品的体积是 vi，价值是 wi 。 求解将哪些物品装入背包，可使这些物品...","permalink":"/post/3 完全背包","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"算法","slug":"算法","count":7,"path":"api/categories/算法.json"}],"tags":[{"name":"动态规划","slug":"动态规划","count":6,"path":"api/tags/动态规划.json"},{"name":"背包","slug":"背包","count":6,"path":"api/tags/背包.json"},{"name":"模板题","slug":"模板题","count":5,"path":"api/tags/模板题.json"},{"name":"easy","slug":"easy","count":4,"path":"api/tags/easy.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">题目描述</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%85%A5%E6%A0%B7%E4%BE%8B\"><span class=\"toc-text\">输入样例</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BE%93%E5%87%BA%E6%A0%B7%E4%BE%8B\"><span class=\"toc-text\">输出样例</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8E%9F%E9%A2%98%E9%93%BE%E6%8E%A5\"><span class=\"toc-text\">原题链接</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF\"><span class=\"toc-text\">解题思路</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">代码</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BC%98%E5%8C%961\"><span class=\"toc-text\">优化1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BC%98%E5%8C%962\"><span class=\"toc-text\">优化2</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E4%BC%BC%E9%A2%98%E7%9B%AE\"><span class=\"toc-text\">相似题目</span></a></li></ol>","author":{"name":"尤一","slug":"blog-author","avatar":"img/cat.jpg","link":"/","description":"社畜码农，热爱设计，热爱编程，热爱生活。","socials":{"github":"https://github.com/StayOne1","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"2 装箱问题","uid":"30e42fe6a21da7424094456c2b5a974a","slug":"2 装箱问题","date":"2025-03-04T16:00:00.000Z","updated":"2025-03-07T14:18:19.888Z","comments":true,"path":"api/articles/2 装箱问题.json","keywords":null,"cover":null,"text":"题目描述 有一个箱子容量为 V，同时有 n 个物品，每个物品有一个体积。 现在从 n 个物品中，任取若干个装入箱内（也可以不取），使箱子的剩余空间最小。输出这个...","permalink":"/post/2 装箱问题","photos":[],"count_time":{"symbolsCount":830,"symbolsTime":"1 mins."},"categories":[{"name":"算法","slug":"算法","count":7,"path":"api/categories/算法.json"}],"tags":[{"name":"动态规划","slug":"动态规划","count":6,"path":"api/tags/动态规划.json"},{"name":"背包","slug":"背包","count":6,"path":"api/tags/背包.json"},{"name":"easy","slug":"easy","count":4,"path":"api/tags/easy.json"}],"author":{"name":"尤一","slug":"blog-author","avatar":"img/cat.jpg","link":"/","description":"社畜码农，热爱设计，热爱编程，热爱生活。","socials":{"github":"https://github.com/StayOne1","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"1 0-1背包","uid":"6cf5ad84fc4af74989856ae444b292c5","slug":"1 0-1背包","date":"2025-03-04T16:00:00.000Z","updated":"2025-03-07T03:41:51.512Z","comments":true,"path":"api/articles/1 0-1背包.json","keywords":null,"cover":null,"text":"题目描述 有 N件物品和一个容量是V的背包。每件物品只能使用一次。 第i件物品的体积是 vi，价值是 wi。 求解将哪些物品装入背包，可使这些物品的总体积不超过...","permalink":"/post/1 0-1背包","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"算法","slug":"算法","count":7,"path":"api/categories/算法.json"}],"tags":[{"name":"动态规划","slug":"动态规划","count":6,"path":"api/tags/动态规划.json"},{"name":"背包","slug":"背包","count":6,"path":"api/tags/背包.json"},{"name":"模板题","slug":"模板题","count":5,"path":"api/tags/模板题.json"},{"name":"easy","slug":"easy","count":4,"path":"api/tags/easy.json"}],"author":{"name":"尤一","slug":"blog-author","avatar":"img/cat.jpg","link":"/","description":"社畜码农，热爱设计，热爱编程，热爱生活。","socials":{"github":"https://github.com/StayOne1","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/","juejin":"","customs":{}}},"feature":true}}